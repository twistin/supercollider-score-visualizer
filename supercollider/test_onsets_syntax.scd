// =============================================================================
// ğŸ§ª TEST ESPECÃFICO PARA ONSETS - SuperCollider
// =============================================================================
// ValidaciÃ³n de diferentes sintaxis para el UGen Onsets
// =============================================================================

(
"ğŸ§ª TEST ESPECÃFICO PARA SINTAXIS DE ONSETS".postln;
"============================================".postln;

// Test 1: Sintaxis con argumentos con nombre (keyword arguments)
"".postln;
"ğŸ“Š Test 1: Onsets con keyword arguments".postln;
"======================================".postln;

try {
    SynthDef(\TestOnsets1, {
        var in, fft, onset;
        in = SinOsc.ar(440) * 0.1;
        fft = FFT(LocalBuf(1024), in);
        
        onset = Onsets.kr(
            chain: fft,
            odftype: \rcomplex,
            threshold: 0.3,
            relaxtime: 1.0,
            floor: 0.1,
            mingap: 10
        );
        
        onset.poll(1, "Onset_Keyword");
        Out.ar(0, Silent.ar(2));
    }).add;
    
    "âœ… Test 1: EXITOSO - Keyword arguments funcionan".postln;
    
} { |error|
    ("âŒ Test 1: Error - " ++ error.errorString).postln;
};

// Test 2: Sintaxis posicional simplificada
"".postln;
"ğŸ“Š Test 2: Onsets sintaxis posicional mÃ­nima".postln;
"==========================================".postln;

try {
    SynthDef(\TestOnsets2, {
        var in, fft, onset;
        in = SinOsc.ar(440) * 0.1;
        fft = FFT(LocalBuf(1024), in);
        
        // Solo argumentos esenciales
        onset = Onsets.kr(fft, \rcomplex, 0.3);
        
        onset.poll(1, "Onset_Simple");
        Out.ar(0, Silent.ar(2));
    }).add;
    
    "âœ… Test 2: EXITOSO - Sintaxis posicional simple funciona".postln;
    
} { |error|
    ("âŒ Test 2: Error - " ++ error.errorString).postln;
};

// Test 3: Sintaxis alternativa con diferentes algoritmos
"".postln;
"ğŸ“Š Test 3: Onsets con diferentes algoritmos".postln;
"=========================================".postln;

[\rcomplex, \hfc, \mkl, \power].do { |algorithm|
    try {
        SynthDef(("TestOnsets_" ++ algorithm).asSymbol, {
            var in, fft, onset;
            in = SinOsc.ar(440) * 0.1;
            fft = FFT(LocalBuf(1024), in);
            
            onset = Onsets.kr(fft, algorithm, 0.3);
            
            onset.poll(1, ("Onset_" ++ algorithm).asSymbol);
            Out.ar(0, Silent.ar(2));
        }).add;
        
        ("âœ… Algoritmo " ++ algorithm ++ ": EXITOSO").postln;
        
    } { |error|
        ("âŒ Algoritmo " ++ algorithm ++ ": Error - " ++ error.errorString).postln;
    };
};

// Test 4: Verificar documentaciÃ³n de Onsets
"".postln;
"ğŸ“Š Test 4: InformaciÃ³n sobre Onsets".postln;
"==================================".postln;

try {
    Onsets.dumpClassSubtree;
    "âœ… Clase Onsets disponible".postln;
    
    // Mostrar ayuda si estÃ¡ disponible
    if (Onsets.respondsTo(\help)) {
        "ğŸ“– Ayuda disponible: Onsets.help".postln;
    };
    
} { |error|
    ("âŒ Error accediendo a clase Onsets: " ++ error.errorString).postln;
};

"".postln;
"ğŸ¯ RECOMENDACIÃ“N:".postln;
"Si Test 1 (keyword) funciona, usar esa sintaxis.".postln;
"Si Test 2 (simple) funciona, usar esa sintaxis.".postln;
"Si ninguno funciona, Onsets puede no estar disponible.".postln;
"".postln;
)
